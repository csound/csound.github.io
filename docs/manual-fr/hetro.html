<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>hetro</title>
    <link rel="stylesheet" type="text/css" href="csound.css" />
    <link rel="stylesheet" type="text/css" href="syntax-highlighting.css" />
    <meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" />
    <link rel="home" href="index.html" title="Manuel de référence canonique de Csound" />
    <link rel="up" href="UtilitySoundfile.html#UtilityAnalysis" title="Génération d'un fichier d'analyse (ATSA, CVANAL, HETRO, LPANAL, PVANAL)" />
    <link rel="prev" href="cvanal.html" title="cvanal" />
    <link rel="next" href="lpanal.html" title="lpanal" />
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">hetro</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="cvanal.html">Précédent</a> </td>
          <th width="60%" align="center">Génération d'un fichier d'analyse (ATSA, CVANAL, HETRO, LPANAL, PVANAL)</th>
          <td width="20%" align="right"> <a accesskey="n" href="lpanal.html">Suivant</a></td>
        </tr>
      </table>
      <hr />
    </div>
    <div class="refentry">
      <a id="hetro"></a>
      <div class="titlepage"></div>
      <div class="refnamediv">
        <h2>
          <span class="refentrytitle">hetro</span>
        </h2>
        <p>hetro — 
      Décompose un fichier son en entrée en composantes sinusoïdales.
      <a id="IndexHetro" class="indexterm"></a>
    </p>
      </div>
      <div class="refsect1">
        <a id="idm441164"></a>
        <h2>Description</h2>
        <p>
      Analyse par filtre hétérodyne pour le générateur de Csound
      <a class="link" href="adsyn.html" title="adsyn"><em class="citetitle">adsyn</em></a>.
    </p>
      </div>
      <div class="refsect1">
        <a id="idm441169"></a>
        <h2>Syntaxe</h2>
        <pre class="synopsis"><span class="command"><strong>csound -U hetro</strong></span> [options] nomfichier_entree nomfichier_sortie</pre>
        <pre class="synopsis"><span class="command"><strong>hetro</strong></span> [options] nomfichier_entree nomfichier_sortie</pre>
      </div>
      <div class="refsect1">
        <a id="idm441175"></a>
        <h2>Initialisation</h2>
        <p>
      <span class="emphasis"><em>hetro</em></span> prend un fichier son en entrée, le décompose en composantes sinusoïdales,
      et sort une description de ces composantes sous la forme de pistes de points charnière d'amplitude
      et de fréquence. L'analyse est conditionnée par les options de contrôle ci-dessous. Un espace est
      facultatif entre drapeau et argument.
    </p>
        <p>
      <span class="emphasis"><em>-s srate</em></span> -- taux d'échantillonnage du fichier audio en entrée. Il remplacera la
      valeur srate de l'en-tête du fichier audio, qui s'applique autrement. Si aucun des deux n'est présent,
      la valeur par défaut est 10000. Noter que pour la synthèse <span class="emphasis"><em>adsyn</em></span> le taux
      d'échantillonnage du fichier source et de l'orchestre générateur n'ont pas à être les-mêmes.
    </p>
        <p>
      <span class="emphasis"><em>-c canal</em></span> -- numéro du canal à traiter. La valeur par défaut est 1.
    </p>
        <p>
      <span class="emphasis"><em>-b début</em></span> -- date de début (en secondes) du segment audio à analyser. La valeur
      par défaut est 0,0
    </p>
        <p>
      <span class="emphasis"><em>-d durée</em></span> -- durée (en secondes) du segment audio à analyser. La valeur par
      défaut de 0,0 signifie jusqu'à la fin du fichier. La longueur maximale est de 32,766 secondes.
    </p>
        <p>
      <span class="emphasis"><em>-f freqdeb</em></span> -- fréquence de départ estimée du fondamental, nécessaire pour
      initialiser l'analyse par le filtre. La valeur par défaut est 100 (cps).
    </p>
        <p>
      <span class="emphasis"><em>-h partiels</em></span> -- nombre d'harmoniques recherchés dans le fichier audio. La valeur
      par défaut est 10, la valeur maximale dépend de la mémoire disponible.
    </p>
        <p>
      <span class="emphasis"><em>-M ampmax</em></span> -- amplitude maximale obtenue par addition sur toutes les pistes
      simultanées. La valeur par défaut est 32767.
    </p>
        <p>
      <span class="emphasis"><em>-m ampmin</em></span> -- seuil d'amplitude en-dessous duquel une paire de pistes
      amplitude/fréquence sera considérée comme inactive et ne contribuera pas à la somme en sortie.
      Valeurs typiques : 128 (48 dB en-dessous de l'échelle complète, 64 (54 dB en-dessous), 32 (60 dB
      en-dessous), 0 (pas de seuillage). Le seuil par défaut est 64 (54 dB en-dessous).
    </p>
        <p>
      <span class="emphasis"><em>-n brkpts</em></span> -- nombre initial de points charnière de l'analyse dans chaque piste
      d'amplitude et de fréquence, avant le seuillage (<span class="emphasis"><em>-m</em></span>) et la consolidation
      linéaire des points charnière. Les points initiaux sont répartis uniformément sur toute la durée.
      La valeur par défaut est 256.
    </p>
        <p>
      <span class="emphasis"><em>-l cutfreq</em></span> -- substitue un filtre passe-bas de Butterworth du 3ème ordre avec
      une fréquence de coupure <span class="emphasis"><em>cutfreq</em></span> (en Hz), à la place du filtre par défaut qui
      est un filtre de moyenne en peigne. La valeur par défaut est 0 (ne pas utiliser).
    </p>
      </div>
      <div class="refsect1">
        <a id="idm441202"></a>
        <h2>Exécution</h2>
        <p>
      A partir de Csound 4.08, <span class="emphasis"><em>hetro</em></span> peut écrire des fichiers de sortie SDIF si le
      nom du fichier de sortie se termine par ".sdif" ou ".SDIF". Voir l'utilitaire
      <a class="link" href="sdif2ad.html" title="sdif2ad"><em class="citetitle">sdif2ad</em></a> pour plus d'information sur le support
      de SDIF dans Csound.
    </p>
      </div>
      <div class="refsect1">
        <a id="idm441208"></a>
        <div class="refsect2">
          <a id="HetroFileFormat"></a>
          <h3>Format de Fichier</h3>
          <p>Le fichier de sortie contient des suites temporelles de valeurs d'amplitude et de fréquence
        pour chaque harmonique d'une source audio additive complexe. L'information se présente sous la
        forme de points charnière (date, valeur, date, valeur, ....) en utilisant des entiers sur 16 bit
        dans l'intervalle 0 - 32767. Le temps est donné en millisecondes, et les fréquences en Hz (cps).
        Les données des points charnières sont exclusivement non-négatives, et les valeurs -1 et -2
        signifient uniquement le début de nouvelles pistes d'amplitude et de fréquence. Une piste se
        termine par la valeur 32767. Avant d'être écrite en sortie, chaque piste subit une
        réduction de données par seuillage d'amplitude et consolidation linéaire des points charnière.
      </p>
          <p>
        Un composant harmonique est défini par deux ensembles de points charnière : un ensemble d'amplitudes,
        et un ensemble de fréquences. Dans un fichier composé ces ensembles peuvent apparaître dans
        n'importe quel ordre (amplitude, fréquence, amplitude ....; ou amplitude, amplitude, ..., puis
        fréquence, fréquence, ...). Durant la resynthèse par
        <a class="link" href="adsyn.html" title="adsyn"><em class="citetitle">adsyn</em></a> les ensembles sont automatiquement
        appariés (amplitude, fréquence) dans l'ordre dans lequel ils sont trouvés. Il doit y avoir un
        nombre égal de chaque sorte.
      </p>
          <p>
        Un fichier de contrôle <span class="emphasis"><em>adsyn</em></span> légal pourrait avoir le format suivant :
        </p>
          <div class="informalexample">
            <pre class="programlisting">
-1 temps1 valeur1 ... tempsK valeurK 32767 ; points charnière d'amplitude pour le partiel 1
-2 temps1 valeur1 ... tempsL valeurL 32767 ; points charnière de fréquence pour le partiel 1
-1 temps1 valeur1 ... tempsM valeurM 32767 ; points charnière d'amplitude pour le partiel 2
-2 temps1 valeur1 ... tempsN valeurN 32767 ; points charnière de fréquence pour le partiel 2
-2 temps1 valeur1 ..........
-2 temps1 valeur1 ..........               ; pistes appariables pour les partiels 3 et 4
-1 temps1 valeur1 ..........
-1 temps1 valeur1 ..........</pre>
          </div>
          <p>
      </p>
        </div>
      </div>
      <div class="refsect1">
        <a id="idm441219"></a>
        <h2>Exemples</h2>
        <p>

        </p>
        <pre class="programlisting">
<span class="emphasis"><em>hetro</em></span> -s44100 -b.5 -d2.5 -h16 -M24000 fichieraudio.test adsynfile7</pre>
        <p>


      Ceci analyse 2,5 secondes du canal 1 du fichier "fichieraudio.test", enregistré à
      44,1 kHz, commençant 0,5 secondes après le début, et place le résultat dans le fichier
      "adsynfile7". Nous ne voulons que les 16 premiers harmoniques du son, avec 256 points
      charnière par piste d'amplitude ou de fréquence, et un pic de la somme des amplitudes de 24000. Le
      fondamental est estimé au commencement  à 100 Hz. Le seuil d'amplitude est de 54 dB en-dessous
      de l'échelle complète.
    </p>
        <p>
      Le filtre passe-bas de Butterworth n'est pas activé.
    </p>
        <p>
      Voici un exemple de l'utilitaire hetro. Il utilise le fichier
      <a class="ulink" href="examples/hetro.csd" target="_top"><em class="citetitle">hetro.csd</em></a>.
      </p>
        <div class="example">
          <a id="idm441228"></a>
          <p class="title">
            <strong>Exemple 1353. Exemple de l'utilitaire hetro.</strong>
          </p>
          <div class="example-contents">
            <p>Voir les sections <a class="link" href="UsingRealTime.html" title="Audio en temps réel"><em class="citetitle">Audio en temps réel</em></a>
        et <a class="link" href="CommandFlags.html" title="Ligne de commande de Csound"><em class="citetitle">Options de la ligne de commande</em></a> pour plus
        d'information sur l'utilisation des options de la ligne de commande.</p>
            <div class="refsect1">
              <a id="idm441235"></a>
              <pre class="programlisting">
<span class="nt">&lt;CsoundSynthesizer&gt;</span>
<span class="nt">&lt;CsOptions&gt;</span>
<span class="c1">; Select audio/midi flags here according to platform</span>
-odac   -m0 --limiter=.95 <span class="c1">;;;realtime audio out, with limiter protection</span>
<span class="c1">; For Non-realtime ouput leave only the line below:</span>
<span class="c1">; -o hetro.wav -W ;;; for file output any platform</span>
<span class="nt">&lt;/CsOptions&gt;</span>
<span class="nt">&lt;CsInstruments&gt;</span><span class="w">

</span><span class="vg">sr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">44100</span><span class="w">
</span><span class="vg">ksmps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="w">
</span><span class="vg">nchnls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="vg">0dbfs</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">

</span><span class="c1">; by Menno Knevel 2021</span><span class="w">

</span>gi<span class="n">len</span><span class="w">  </span><span class="nb">filelen</span><span class="w"> </span><span class="s">"fox.wav"</span><span class="w">	    </span><span class="c1">; get length of soundfile</span><span class="w">

</span><span class="c1">; analyze sound file and output result to 3 hetro files</span><span class="w">
</span>i<span class="n">res1</span><span class="w"> </span><span class="nb">system_i</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="s">{{ hetro fox.wav fox1.het }}</span><span class="w">           </span><span class="c1">; default settings</span><span class="w">
</span>i<span class="n">res2</span><span class="w"> </span><span class="nb">system_i</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="s">{{ hetro -f250 fox.wav fox2.het }}</span><span class="w">     </span><span class="c1">; high starting frequency</span><span class="w">
</span>i<span class="n">res3</span><span class="w"> </span><span class="nb">system_i</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="s">{{ hetro -f100 -h180 fox.wav fox3.het }}</span><span class="c1">; up to 18kHz!</span><span class="w">

</span><span class="kd">instr</span><span class="w"> </span><span class="nf">1</span><span class="w"> </span><span class="c1">; untreated signal</span><span class="w">
</span>a<span class="n">sig</span><span class="w">    </span><span class="nb">diskin2</span><span class="w">   </span><span class="s">"fox.wav"</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="nb">prints</span><span class="w">  </span><span class="s">"</span><span class="se">\n</span><span class="s">---***YOU NOW HEAR THE UNTREATED SOUND SAMPLE***---</span><span class="se">\n</span><span class="s">"</span><span class="w">
</span><span class="nb">prints</span><span class="w"> </span><span class="s">"---*duration of soundfile is </span><span class="si">%f</span><span class="s"> seconds*---</span><span class="se">\\n</span><span class="s">"</span><span class="p">,</span>gi<span class="n">len</span><span class="w">
</span><span class="nb">outs</span><span class="w">    </span>a<span class="n">sig</span><span class="p">,</span><span class="w"> </span>a<span class="n">sig</span><span class="w">
</span><span class="kd">endin</span><span class="w">

</span><span class="kd">instr</span><span class="w"> </span><span class="nf">2</span><span class="w">
</span><span class="nb">prints</span><span class="w">  </span><span class="s">"</span><span class="se">\n</span><span class="s">---***YOU NOW HEAR THE RESULT OF THIS ANALYZED FILE:***---</span><span class="se">\n</span><span class="s">"</span><span class="w">
</span>a<span class="n">sig</span><span class="w">      </span><span class="nb">adsyn</span><span class="w">     </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="vi">p4</span><span class="w"> 
</span><span class="nb">outs</span><span class="w"> </span>a<span class="n">sig</span><span class="p">,</span><span class="w"> </span>a<span class="n">sig</span><span class="w">	    
</span><span class="kd">endin</span><span class="w">

</span><span class="nt">&lt;/CsInstruments&gt;</span>
<span class="nt">&lt;CsScore&gt;</span><span class="w">

</span><span class="nb">i</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mf">2.76</span><span class="w">               </span><span class="c1">; original sample</span><span class="w">

</span><span class="nb">i</span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mf">2.76</span><span class="w">  </span><span class="s">"fox1.het"</span><span class="w">	</span><span class="c1">; whole sentence</span><span class="w">
</span><span class="nb">i</span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mf">2.76</span><span class="w"> </span><span class="s">"fox2.het"</span><span class="w">	</span><span class="c1">; whole sentence, but analyzed with different settings</span><span class="w">
</span><span class="nb">i</span><span class="mi">2</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mf">2.76</span><span class="w"> </span><span class="s">"fox3.het"</span><span class="w">	</span><span class="c1">; whole sentence, and again analyzed with different settings</span><span class="w">
</span><span class="nb">e</span><span class="w">
</span><span class="nt">&lt;/CsScore&gt;</span>
<span class="nt">&lt;/CsoundSynthesizer&gt;</span>
</pre>
            </div>
          </div>
        </div>
        <p><br class="example-break" />
    </p>
      </div>
      <div class="refsect1">
        <a id="idm441438"></a>
        <h2>Crédits</h2>
        <p>
        </p>
        <table border="0" summary="Simple list" class="simplelist">
          <tr>
            <td>Auteur : Tom Sullivan</td>
          </tr>
          <tr>
            <td>1992</td>
          </tr>
          <tr>
            <td>Auteur : John ffitch</td>
          </tr>
          <tr>
            <td>1994</td>
          </tr>
          <tr>
            <td>Auteur : Richard Dobson</td>
          </tr>
          <tr>
            <td>2000</td>
          </tr>
        </table>
        <p>
        </p>
        <p>
      Octobre 2002. Merci à Rasmus Ekman, pour l'addition d'une note au sujet du format SDIF.
    </p>
      </div>
    </div>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="cvanal.html">Précédent</a> </td>
          <td width="20%" align="center">
            <a accesskey="u" href="UtilitySoundfile.html#UtilityAnalysis">Niveau supérieur</a>
          </td>
          <td width="40%" align="right"> <a accesskey="n" href="lpanal.html">Suivant</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">cvanal </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">Sommaire</a>
          </td>
          <td width="40%" align="right" valign="top"> lpanal</td>
        </tr>
      </table>
    </div>
  </body>
</html>
