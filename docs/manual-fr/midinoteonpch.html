<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>midinoteonpch</title>
    <link rel="stylesheet" type="text/css" href="csound.css" />
    <link rel="stylesheet" type="text/css" href="syntax-highlighting.css" />
    <meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" />
    <link rel="home" href="index.html" title="Manuel de référence canonique de Csound" />
    <link rel="up" href="OpcodesTop.html" title="Opcodes et opérateurs de l'orchestre" />
    <link rel="prev" href="midinoteonoct.html" title="midinoteonoct" />
    <link rel="next" href="midion2.html" title="midion2" />
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">midinoteonpch</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="midinoteonoct.html">Précédent</a> </td>
          <th width="60%" align="center">Opcodes et opérateurs de l'orchestre</th>
          <td width="20%" align="right"> <a accesskey="n" href="midion2.html">Suivant</a></td>
        </tr>
      </table>
      <hr />
    </div>
    <div class="refentry">
      <a id="midinoteonpch"></a>
      <div class="titlepage"></div>
      <a id="IndexMidinoteonpch" class="indexterm"></a>
      <div class="refnamediv">
        <h2>
          <span class="refentrytitle">midinoteonpch</span>
        </h2>
        <p>midinoteonpch — 
      Retourne un numéro de note MIDI traduit en classe de hauteur.
    </p>
      </div>
      <div class="refsect1">
        <a id="idm205169"></a>
        <h2>Description</h2>
        <p>
      <span class="emphasis"><em>midinoteonpch</em></span> est conçu pour simplifier
      l'écriture d'instruments que l'on peut utiliser de manière interchangeable
      avec une partition ou depuis l'entrée MIDI, et pour faciliter l'adaptation
      d'instruments écrits à l'origine pour une partition au fonctionnement à
      partir d'une entrée MIDI.
    </p>
        <p>
      En général, il doit être possible d'écrire des définitions d'instrument
      qui fonctionnent de la même manière avec une partition et avec le MIDI, que
      ce soit un fichier MIDI ou une entrée MIDI en , sans utiliser
      d'instructions conditionnelles supplémentaires, et qui tirent pleinement
      avantage des messages de voix MIDI.
    </p>
        <p>
      Noter que la liaison entre des intruments de Csound et les numéros de
      canal MIDI se fait en utilisant l'opcode
      <a class="link" href="massign.html" title="massign"><em class="citetitle">massign</em></a> lors d'une
      exécution en . Pour les exécutions de fichier MIDI, les numéros
      d'instruments sont liés par défaut au canal MIDI + 1, mais ces valeurs par
      défaut peuvent être modifiées par tout message de changement de programme
      dans le fichier.
    </p>
      </div>
      <div class="refsect1">
        <a id="idm205177"></a>
        <h2>Syntaxe</h2>
        <pre class="synopsis"><span class="command"><strong>midinoteonpch</strong></span> xpch, xvelocity</pre>
      </div>
      <div class="refsect1">
        <a id="idm205181"></a>
        <h2>Exécution</h2>
        <p>
      <span class="emphasis"><em>xpch</em></span> -- retourne une touche MIDI traduite en classe
      de hauteur durant l'activation MIDI, et reste inchangé dans les autres cas.
    </p>
        <p>
      <span class="emphasis"><em>xvelocity</em></span> -- retourne une vélocité MIDI durant
      l'activation MIDI, et reste inchangé dans les autres cas.
    </p>
        <p>
      Si l'instrument a été activé par une entrée MIDI, l'opcode remplace les
      valeurs de <span class="emphasis"><em>xpch</em></span> et de <span class="emphasis"><em>xvelocity</em></span>
      par les valeurs correspondantes venant de l'entrée MIDI. Si l'instrument
      n'a <span class="emphasis"><em>PAS</em></span> été activé par une entrée MIDI, les valeurs
      de <span class="emphasis"><em>xpch</em></span> et de <span class="emphasis"><em>xvelocity</em></span>
      restent inchangées.
    </p>
        <p>
      Grâce à cela, les p-champs de la partition peuvent recevoir leur valeur
      de données MIDI en entrée durant l'activation MIDI, et de la partition
      dans les autres cas.
    </p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note: Adaptation d'un instrument de Csound activé par partition.">
            <tr>
              <td rowspan="2" align="center" valign="top" width="25">
                <img alt="[Note]" src="images/note.png" />
              </td>
              <th align="left">Adaptation d'un instrument de Csound activé par partition.</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>
        Voir la section <a class="link" href="MidiInterop.html" title="Opcodes pour l'interopérabilité MIDI/partition"><em class="citetitle">Opcodes pour
        l'Interopérabilité MIDI/Partition</em></a> pour plus de détails
        sur l'adaptation d'instruments pilotés par partition au MIDI et vice-versa.
      </p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="refsect1">
        <a id="idm205199"></a>
        <h2>Exemples</h2>
        <p>
      Voici un exemple de l'opcode midinoteonpch. Il utilise le fichier
      <a class="ulink" href="examples/midinoteonpch.csd" target="_top"><em class="citetitle">midinoteonpch.csd</em></a>.

      </p>
        <div class="example">
          <a id="idm205204"></a>
          <p class="title">
            <strong>Exemple 603. Exemple de l'opcode midinoteonpch.</strong>
          </p>
          <div class="example-contents">
            <p>Voir les sections <a class="link" href="UsingRealTime.html" title="Audio en temps réel"><em class="citetitle">Audio en Temps Réel</em></a>
        et <a class="link" href="CommandFlags.html" title="Ligne de commande de Csound"><em class="citetitle">Options de la Ligne de Commande</em></a> pour plus
        d'information sur l'utilisation des options de la ligne de commande.</p>
            <div class="refsect1">
              <a id="idm205211"></a>
              <pre class="programlisting">
<span class="nt">&lt;CsoundSynthesizer&gt;</span>
<span class="nt">&lt;CsOptions&gt;</span>
<span class="c1">; Select audio/midi flags here according to platform</span>
-odac    -M1  <span class="c1">;;;realtime audio out and midi in </span>
<span class="c1">;-iadc    ;;;uncomment -iadc if realtime audio input is needed too</span>
<span class="c1">; For Non-realtime ouput leave only the line below:</span>
<span class="c1">; -o midinoteonpch.wav -W ;;; for file output any platform</span>
<span class="nt">&lt;/CsOptions&gt;</span>
<span class="nt">&lt;CsInstruments&gt;</span><span class="w">

</span><span class="vg">sr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">44100</span><span class="w">
</span><span class="vg">ksmps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="w">
</span><span class="vg">nchnls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="vg">0dbfs</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">

</span><span class="kd">instr</span><span class="w"> </span><span class="nf">1</span><span class="w">

</span><span class="nb">midinoteonpch</span><span class="w"> </span><span class="vi">p4</span><span class="p">,</span><span class="w"> </span><span class="vi">p5</span><span class="w">				</span><span class="c1">;gets a MIDI note number value as octave-point-decimal value into p4, and MIDI velocity into p5</span><span class="w">

</span><span class="nb">print</span><span class="w"> 	</span><span class="vi">p4</span><span class="w">					</span><span class="c1">;display the pitch value when it changes and when key is pressed </span><span class="w">
</span>k<span class="n">vel</span><span class="w"> </span><span class="o">=</span><span class="w">  </span>k<span class="n">vel</span><span class="o">/</span><span class="mi">127</span><span class="w">				</span><span class="c1">;scale midi velocity to 0-1</span><span class="w">
</span>i<span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w">	</span><span class="vi">p4</span><span class="w">
</span>i<span class="n">cps</span><span class="w"> </span><span class="o">=</span><span class="w">	</span><span class="nb">cpspch</span><span class="p">(</span>i<span class="n">pch</span><span class="p">)</span><span class="w">				</span><span class="c1">;convert octave-point-decimal value into Hz</span><span class="w">
</span>k<span class="n">env</span><span class="w"> </span><span class="nb">madsr</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="w">			</span><span class="c1">;amplitude envelope multiplied by</span><span class="w">
</span>a<span class="n">sig</span><span class="w"> </span><span class="nb">pluck</span><span class="w"> </span>k<span class="n">env</span><span class="o">*</span>k<span class="n">vel</span><span class="p">,</span><span class="w"> </span>i<span class="n">cps</span><span class="p">,</span><span class="w"> </span>i<span class="n">cps</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">		</span><span class="c1">;velocity value			</span><span class="w">
     </span><span class="nb">outs</span><span class="w">  </span>a<span class="n">sig</span><span class="p">,</span><span class="w"> </span>a<span class="n">sig</span><span class="w">				

</span><span class="kd">endin</span><span class="w">
</span><span class="nt">&lt;/CsInstruments&gt;</span>
<span class="nt">&lt;CsScore&gt;</span><span class="w">
</span><span class="nb">f</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">30</span><span class="w">	</span><span class="c1">;runs for 30 seconds</span><span class="w">
</span><span class="nb">f</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4096</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">1</span><span class="w">	

</span><span class="nb">i</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mf">8.09</span><span class="w"> </span><span class="mi">100</span><span class="w">	</span><span class="c1">; play these notes from score as well</span><span class="w">
</span><span class="nb">i</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mf">9.05</span><span class="w"> </span><span class="mi">100</span><span class="w">
</span><span class="nb">e</span><span class="w">

</span><span class="nt">&lt;/CsScore&gt;</span>
<span class="nt">&lt;/CsoundSynthesizer&gt;</span>
</pre>
            </div>
          </div>
        </div>
        <p><br class="example-break" />

      Sa sortie contiendra des lignes comme celles-ci :
      </p>
        <pre class="screen">
 i1     8.09000
 i1     9.05000</pre>
        <p>
    </p>
      </div>
      <div class="refsect1">
        <a id="idm205395"></a>
        <h2>Voir aussi</h2>
        <p>
      <a class="link" href="midichannelaftertouch.html" title="midichannelaftertouch"><em class="citetitle">midichannelaftertouch</em></a>, 
      <a class="link" href="midicontrolchange.html" title="midicontrolchange"><em class="citetitle">midicontrolchange</em></a>, 
      <a class="link" href="mididefault.html" title="mididefault"><em class="citetitle">mididefault</em></a>, 
      <a class="link" href="midinoteoff.html" title="midinoteoff"><em class="citetitle">midinoteoff</em></a>, 
      <a class="link" href="midinoteoncps.html" title="midinoteoncps"><em class="citetitle">midinoteoncps</em></a>, 
      <a class="link" href="midinoteonkey.html" title="midinoteonkey"><em class="citetitle">midinoteonkey</em></a>, 
      <a class="link" href="midinoteonoct.html" title="midinoteonoct"><em class="citetitle">midinoteonoct</em></a>, 
      <a class="link" href="midipitchbend.html" title="midipitchbend"><em class="citetitle">midipitchbend</em></a>, 
      <a class="link" href="midipolyaftertouch.html" title="midipolyaftertouch"><em class="citetitle">midipolyaftertouch</em></a>, 
      <a class="link" href="midiprogramchange.html" title="midiprogramchange"><em class="citetitle">midiprogramchange</em></a>
    </p>
      </div>
      <div class="refsect1">
        <a id="idm205418"></a>
        <h2>Crédits</h2>
        <p>Auteur : Michael Gogins</p>
        <p>Nouveau dans la version 4.20</p>
      </div>
    </div>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="midinoteonoct.html">Précédent</a> </td>
          <td width="20%" align="center">
            <a accesskey="u" href="OpcodesTop.html">Niveau supérieur</a>
          </td>
          <td width="40%" align="right"> <a accesskey="n" href="midion2.html">Suivant</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">midinoteonoct </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">Sommaire</a>
          </td>
          <td width="40%" align="right" valign="top"> midion2</td>
        </tr>
      </table>
    </div>
  </body>
</html>
